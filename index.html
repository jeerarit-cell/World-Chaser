<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>WORLD CHASER - FINAL</title>
    <style>
        :root { 
            --neon: #FF9500; 
            --neon-hot: #FF5E00;
            --bg: #0a0a0c; 
            --card: #1a1a1e; 
            --border: #2d2d33; 
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        html, body { position: fixed; overflow: hidden; width: 100%; height: 100%; margin: 0; padding: 0; background: var(--bg); color: white; font-family: -apple-system, sans-serif; }

        /* Ticker */
        .news-ticker { background: #000; color: var(--neon); padding: 7px 0; font-size: 0.75rem; border-bottom: 1px solid var(--neon-hot); white-space: nowrap; overflow: hidden; flex-shrink: 0; }
        .ticker-text { display: inline-block; animation: ticker 25s linear infinite; padding-left: 100%; }
        @keyframes ticker { 0% { transform: translate(0, 0); } 100% { transform: translate(-100%, 0); } }

        .screen { display: none; height: 100vh; flex-direction: column; width: 100%; max-width: 500px; margin: 0 auto; background: radial-gradient(circle at top, #2b1a0a 0%, #0a0a0c 100%); position: relative; }
        .active { display: flex; }

        /* Lobby Room Selection */
        .room-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; width: 100%; margin: 15px 0; }
        .room-btn { background: rgba(255,255,255,0.03); border: 1px solid var(--border); border-radius: 12px; padding: 12px; color: #555; cursor: pointer; text-align: center; }
        .room-btn b { display: block; font-size: 1.2rem; }
        .room-btn span { font-size: 0.6rem; letter-spacing: 1px; }
        .room-btn.selected { border-color: var(--neon); background: rgba(255,149,0,0.15); color: var(--neon); box-shadow: 0 0 15px rgba(255,149,0,0.1); }

        /* Top Bar & Stats */
        .top-nav { display: flex; justify-content: space-between; padding: 10px 15px; background: rgba(0,0,0,0.8); align-items: center; border-bottom: 1px solid var(--border); flex-shrink: 0; }
        .stats-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; padding: 10px 15px; flex-shrink: 0; }
        .stat-card { background: var(--card); border: 1px solid var(--border); padding: 8px; border-radius: 10px; text-align: center; font-size: 0.65rem; color: #777; }
        .stat-card b { color: var(--neon); font-size: 0.85rem; display: block; margin-top: 2px; }

        /* Board 2 ‡πÅ‡∏ñ‡∏ß ‡πÅ‡∏ñ‡∏ß‡∏•‡∏∞ 6 (2x6) */
        .board-container { padding: 0 15px 10px 15px; display: grid; grid-template-columns: repeat(6, 1fr); gap: 5px; flex-shrink: 0; }
        .slot { aspect-ratio: 1/1; background: #0e0e10; border: 1px solid #1f1f23; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 8px; color: #333; transition: 0.3s; }
        .slot.active-chaser { border-color: var(--neon); box-shadow: 0 0 12px var(--neon-hot); background: rgba(255, 149, 0, 0.2); color: white !important; font-weight: bold; }

        /* Main Game Layout */
        .main-content { display: flex; padding: 0 15px 10px 15px; gap: 10px; align-items: flex-start; }
        .left-panel { flex: 1.6; display: flex; flex-direction: column; gap: 6px; }
        .status-row { display: flex; gap: 6px; }
        .status-pill { flex: 1; background: rgba(255,255,255,0.03); border: 1px solid var(--border); border-radius: 8px; padding: 5px; text-align: center; font-size: 0.6rem; color: #666; }

        /* ‡∏•‡πá‡∏≠‡∏Ñ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏ä‡πà‡∏≠‡∏á‡πÅ‡∏ä‡∏ó */
        .chat-section { height: 320px; border: 2px solid #ffffff; border-radius: 18px; background: rgba(0,0,0,0.8); display: flex; flex-direction: column; overflow: hidden; }
        #chatBox { flex: 1; padding: 10px; overflow-y: auto; font-size: 0.8rem; scroll-behavior: smooth; }
        .chat-input-row { padding: 8px 12px; background: #000; border-top: 1px solid var(--border); }
        .chat-input-row input { width: 100%; background: transparent; border: none; color: var(--neon); font-size: 13px; }

        /* ‡∏•‡πá‡∏≠‡∏Ñ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡πÅ‡∏ú‡∏á‡πÄ‡∏°‡∏ô‡∏π‡∏Ç‡∏ß‡∏≤ */
        .menu-section { flex: 1; display: flex; flex-direction: column; gap: 8px; height: 360px; }
        .btn-play-action { flex: 2; background: linear-gradient(145deg, #ff9500, #ff5e00); border: none; color: #000; border-radius: 15px; font-size: 1.2rem; font-weight: 900; cursor: pointer; line-height: 1.1; }
        .btn-menu-sub { flex: 0.7; background: var(--card); border: 1px solid var(--border); color: #ccc; border-radius: 10px; font-size: 0.7rem; font-weight: bold; cursor: pointer; }

        /* Overlay */
        .overlay-panel { display: none; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: var(--bg); z-index: 500; padding: 20px; flex-direction: column; }
        .panel-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
    </style>
</head>
<body>

<div class="news-ticker">
    <div class="ticker-text" id="tickerText">üî• WELCOME TO WORLD CHASER: ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏•‡πà‡∏≤‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ!</div>
</div>

<div id="lobby" class="screen active">
    <div style="flex:1; display:flex; flex-direction:column; align-items:center; justify-content:center; padding:30px;">
        <h1 style="color:#fff; font-size: 2.4rem; margin: 0; letter-spacing: -1px;">WORLD</h1>
        <h1 style="color:var(--neon); font-size: 2.4rem; margin: -10px 0 20px 0; letter-spacing: -1px;">CHASER</h1>
        
        <input type="text" id="userNameInp" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô..." maxlength="12" style="width:100%; padding:15px; border-radius:12px; border:1px solid var(--border); background:rgba(255,255,255,0.05); color:white; margin-bottom:10px; text-align:center; font-size: 1rem;">

        <div class="room-grid">
            <div class="room-btn selected" onclick="selectRoom(0.001, this)"><b>0.001</b><span>WLD/ENTRY</span></div>
            <div class="room-btn" onclick="selectRoom(0.01, this)"><b>0.01</b><span>WLD/ENTRY</span></div>
            <div class="room-btn" onclick="selectRoom(0.1, this)"><b>0.1</b><span>WLD/ENTRY</span></div>
            <div class="room-btn" onclick="selectRoom(1.0, this)"><b>1.0</b><span>WLD/ENTRY</span></div>
        </div>

        <button onclick="joinGame()" style="width:100%; padding:18px; background:var(--neon); border:none; border-radius:15px; font-weight:900; font-size: 1.2rem; color:#000; box-shadow: 0 4px 15px rgba(255,149,0,0.3);">JOIN ROOM</button>
    </div>
</div>

<div id="game" class="screen">
    <div id="historyPanel" class="overlay-panel">
        <div class="panel-header">
            <b style="color:var(--neon); font-size: 1.2rem;">HISTORY (100 ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î)</b>
            <button onclick="closeOverlay('historyPanel')" style="background:var(--card); border:1px solid var(--border); color:white; padding:8px 15px; border-radius:8px;">‡∏õ‡∏¥‡∏î</button>
        </div>
        <div id="historyContent" style="flex:1; overflow-y:auto;"></div>
    </div>

    <div id="leaderboardPanel" class="overlay-panel">
        <div class="panel-header">
            <b style="color:var(--neon); font-size: 1.2rem;">TOP 100 PLAYERS</b>
            <button onclick="closeOverlay('leaderboardPanel')" style="background:var(--card); border:1px solid var(--border); color:white; padding:8px 15px; border-radius:8px;">‡∏õ‡∏¥‡∏î</button>
        </div>
        <div id="leaderboardContent" style="flex:1; overflow-y:auto;"></div>
    </div>

    <div id="earnPanel" class="overlay-panel" style="justify-content:center; align-items:center; text-align:center;">
        <h1 style="color:var(--neon); margin:0;">EARN</h1>
        <p style="color:#555; margin-bottom: 25px;">Coming Soon: ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ä‡∏ß‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô</p>
        <button onclick="closeOverlay('earnPanel')" style="background:var(--card); border:1px solid var(--border); color:white; padding:12px 40px; border-radius:10px;">‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
    </div>

    <div class="top-nav">
        <button onclick="location.reload()" style="background:none; border:1px solid var(--border); color:white; border-radius:8px; padding:4px 10px;">‚Üê</button>
        <b id="headerPlayerName" style="font-size: 0.9rem;">PLAYER</b>
        <div id="roomTag" style="color:var(--neon); font-weight:bold; font-size: 0.8rem;">WLD 0.001</div>
    </div>

    <div class="stats-grid">
        <div class="stat-card">PRIZE (WLD)<br><b id="prizeDisplay">0.0000</b></div>
        <div class="stat-card">TIME<br><b id="timer">WAIT</b></div>
        <div class="stat-card">PLAYERS<br><b id="pCountTop">0/12</b></div>
    </div>

    <div class="board-container" id="board"></div>

    <div class="main-content">
        <div class="left-panel">
            <div class="status-row">
                <div class="status-pill">ROUND <b id="roundNum" style="color:var(--neon)">#125</b></div>
                <div class="status-pill">ONLINE <b id="onlineCount" style="color:var(--neon)">17</b></div>
            </div>
            <div class="chat-section">
                <div id="chatBox"></div>
                <div class="chat-input-row">
                    <input type="text" id="chatInp" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°..." onkeydown="if(event.key==='Enter') sendMsg()">
                </div>
            </div>
        </div>
        <div class="menu-section">
            <button class="btn-play-action" id="btnPlay" onclick="play()">PLAY</button>
            <button class="btn-menu-sub" onclick="openOverlay('historyPanel')">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</button>
            <button class="btn-menu-sub" onclick="openOverlay('leaderboardPanel')">‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö</button>
            <button class="btn-menu-sub" onclick="openOverlay('earnPanel')" style="color:var(--neon)">EARN</button>
        </div>
    </div>
</div>

<script>
    let currentPlayerName = "GUEST", players = [], hasJoined = false, timerStarted = false;
    let round = 125, gameHistory = [], leaderData = {}, ENTRY_FEE = 0.001;
    const HOUSE_FEE = 0.15, MAX_PLAYERS = 12;

    function selectRoom(fee, btn) {
        ENTRY_FEE = fee;
        document.querySelectorAll('.room-btn').forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
    }

    function openOverlay(id) {
        document.getElementById(id).style.display = 'flex';
        if(id === 'leaderboardPanel') renderLeaderboard();
        if(id === 'historyPanel') renderHistory();
    }
    function closeOverlay(id) { document.getElementById(id).style.display = 'none'; }

    function joinGame() {
        const name = document.getElementById('userNameInp').value.trim();
        currentPlayerName = name || "USER_" + Math.floor(Math.random()*999);
        document.getElementById('headerPlayerName').innerText = currentPlayerName.toUpperCase();
        document.getElementById('roomTag').innerText = "WLD " + ENTRY_FEE;
        document.getElementById('btnPlay').innerHTML = `PLAY<br><span style="font-size:0.65rem; font-weight:normal;">${ENTRY_FEE} WLD</span>`;
        document.getElementById('lobby').classList.remove('active');
        document.getElementById('game').classList.add('active');
        updateBoard();
        document.getElementById('onlineCount').innerText = Math.floor(Math.random()*15)+10;
    }

    function updateBoard() {
        const b = document.getElementById('board'); b.innerHTML = "";
        for(let i=0; i < MAX_PLAYERS; i++){
            const s = document.createElement('div'); s.className = 'slot';
            if(players[i]) {
                s.innerText = players[i].substring(0, 5).toUpperCase();
                s.style.color = "var(--neon)"; s.style.borderColor = "var(--neon)";
            }
            b.appendChild(s);
        }
        const prize = (players.length >= 2) ? ((players.length * ENTRY_FEE) * (1-HOUSE_FEE)).toFixed(4) : "0.0000";
        document.getElementById('prizeDisplay').innerText = prize;
        document.getElementById('pCountTop').innerText = `${players.length}/12`;
    }

    function play() {
        if(hasJoined) return;
        hasJoined = true;
        players.push(currentPlayerName); updateBoard();
        document.getElementById('btnPlay').disabled = true; document.getElementById('btnPlay').style.opacity = "0.5";
        
        // ‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏ö‡∏≠‡∏ó‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡πâ‡∏≠‡∏á
        let itv = setInterval(() => {
            if(players.length < MAX_PLAYERS) {
                players.push("BOT_" + Math.floor(Math.random()*99));
                updateBoard();
                if(players.length >= 2 && !timerStarted) startCountdown();
            } else clearInterval(itv);
        }, 800);
    }

    function startCountdown() {
        timerStarted = true; let sec = 15;
        const cItv = setInterval(() => {
            sec--; document.getElementById('timer').innerText = sec + "s";
            if(sec <= 0) { clearInterval(cItv); document.getElementById('timer').innerText = "LIVE"; runGame(); }
        }, 1000);
    }

    function runGame() {
        const slots = document.querySelectorAll('.slot');
        let cur = 0, speed = 60, steps = 0;
        const winIdx = Math.floor(Math.random() * players.length);
        const total = 36 + winIdx;
        function move() {
            slots.forEach(s => s.classList.remove('active-chaser'));
            cur = (cur + 1) % MAX_PLAYERS;
            slots[cur].classList.add('active-chaser');
            steps++;
            if(steps < total || cur !== winIdx) {
                if(total - steps < 10) speed += 40;
                setTimeout(move, speed);
            } else finish(cur);
        }
        move();
    }

    function finish(idx) {
        const winner = players[idx];
        const amount = parseFloat(document.getElementById('prizeDisplay').innerText);
        gameHistory.unshift({ round: round, winner: winner, amount: amount.toFixed(4) });
        if(gameHistory.length > 100) gameHistory.pop();
        leaderData[winner] = (leaderData[winner] || 0) + amount;
        
        document.getElementById('tickerText').innerText = `üéä ROUND #${round} WINNER: ${winner} WON ${amount.toFixed(4)} WLD! üéä`;
        addChat("üèÜ SYSTEM", `${winner} ‡∏ä‡∏ô‡∏∞‡∏£‡∏±‡∏ö ${amount.toFixed(4)} WLD`, "color:#000; background:var(--neon); font-weight:bold; padding:0 4px; border-radius:4px;");
        setTimeout(reset, 5000);
    }

    function renderHistory() {
        const h = document.getElementById('historyContent');
        h.innerHTML = gameHistory.map(i => `<div style="padding:12px; border-bottom:1px solid #1a1a1e;">‡∏£‡∏≠‡∏ö #${i.round} | <b>${i.winner}</b> <span style="color:var(--neon); float:right;">${i.amount} WLD</span></div>`).join('') || "<p style='text-align:center; color:#444;'>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</p>";
    }

    function renderLeaderboard() {
        const l = document.getElementById('leaderboardContent');
        const sorted = Object.entries(leaderData).sort((a,b) => b[1] - a[1]).slice(0, 100);
        l.innerHTML = sorted.map((i, idx) => `<div style="padding:12px; border-bottom:1px solid #1a1a1e;">${idx+1}. <b>${i[0]}</b> <span style="color:var(--neon); float:right;">${i[1].toFixed(4)} WLD</span></div>`).join('') || "<p style='text-align:center; color:#444;'>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>";
    }

    function reset() {
        round++; document.getElementById('roundNum').innerText = "#" + round;
        players = []; hasJoined = false; timerStarted = false;
        document.getElementById('timer').innerText = "WAIT"; updateBoard();
        document.getElementById('btnPlay').disabled = false; document.getElementById('btnPlay').style.opacity = "1";
    }

    function addChat(u, m, s='') {
        const b = document.getElementById('chatBox');
        b.innerHTML += `<div style="margin-bottom:6px; font-size:0.75rem;"><b style="${s}">${u}:</b> <span style="color:#ddd">${m}</span></div>`;
        b.scrollTop = b.scrollHeight;
    }

    function sendMsg() {
        const i = document.getElementById('chatInp');
        if(i.value.trim()) { addChat(currentPlayerName, i.value, "color:var(--neon)"); i.value = ""; }
    }
</script>
</body>
</html>
